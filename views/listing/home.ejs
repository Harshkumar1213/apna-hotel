<%layout("/layouts/boilerplate")%>
<body>
  <div id="filters">
    <div class="slider">
      <div class="slider-wrapper" style="position:relative;">
        <button class="arrow-button arrow-left" aria-label="Scroll left">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </button>
    
        <div class="icon-slider" role="list" aria-label="Category selector">
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="true" title="Home">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            </div>
            <div class="icon-label">Home</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Experiences">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"/></svg>
            </div>
            <div class="icon-label">Experiences</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Restaurants">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9v9c0 1.1.9 2 2 2h2v-7H7v-2c0-2.21 1.79-4 4-4s4 1.79 4 4v2h-2v7h2c1.1 0 2-.9 2-2v-9c0-3.87-3.13-7-7-7z"/></svg>
            </div>
            <div class="icon-label">Restaurants</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Online Experiences">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M10.9 2a7 7 0 0 1 6.14 10.57l-1.79-1.79a5 5 0 1 0-6.92 6.92l-2.83 2.83a1 1 0 0 1-1.41-1.41l2.83-2.83a5 5 0 0 0 1.95-3.52v-.02A7 7 0 0 1 10.9 2z"/></svg>
            </div>
            <div class="icon-label">Online</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Adventures">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M13 2v8h8v4h-8v8h-4v-8H2v-4h8V2z"/></svg>
            </div>
            <div class="icon-label">Adventures</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Nightlife">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 12h8v2H8z"/></svg>
            </div>
            <div class="icon-label">Nightlife</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Wellness">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 0-4 4v3H9a3 3 0 0 1 6 0h1v-3a4 4 0 0 0-4-4z"/></svg>
            </div>
            <div class="icon-label">Wellness</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Family">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3z"/></svg>
            </div>
            <div class="icon-label">Family</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Nature">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M11 20v-6H8l4-8 4 8h-3v6z"/></svg>
            </div>
            <div class="icon-label">Nature</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="true" title="Home">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            </div>
            <div class="icon-label">Home</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Experiences">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"/></svg>
            </div>
            <div class="icon-label">Experiences</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Restaurants">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9v9c0 1.1.9 2 2 2h2v-7H7v-2c0-2.21 1.79-4 4-4s4 1.79 4 4v2h-2v7h2c1.1 0 2-.9 2-2v-9c0-3.87-3.13-7-7-7z"/></svg>
            </div>
            <div class="icon-label">Restaurants</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Online Experiences">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M10.9 2a7 7 0 0 1 6.14 10.57l-1.79-1.79a5 5 0 1 0-6.92 6.92l-2.83 2.83a1 1 0 0 1-1.41-1.41l2.83-2.83a5 5 0 0 0 1.95-3.52v-.02A7 7 0 0 1 10.9 2z"/></svg>
            </div>
            <div class="icon-label">Online</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Adventures">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M13 2v8h8v4h-8v8h-4v-8H2v-4h8V2z"/></svg>
            </div>
            <div class="icon-label">Adventures</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Nightlife">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 12h8v2H8z"/></svg>
            </div>
            <div class="icon-label">Nightlife</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Wellness">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 0-4 4v3H9a3 3 0 0 1 6 0h1v-3a4 4 0 0 0-4-4z"/></svg>
            </div>
            <div class="icon-label">Wellness</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Family">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3z"/></svg>
            </div>
            <div class="icon-label">Family</div>
          </div>
          <div class="icon-item" role="listitem" tabindex="0" aria-selected="false" title="Nature">
            <div class="icon-circle" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M11 20v-6H8l4-8 4 8h-3v6z"/></svg>
            </div>
            <div class="icon-label">Nature</div>
          </div>
        </div>
    
        <button class="arrow-button arrow-right" aria-label="Scroll right">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg>
        </button>
      </div>
    </div>
    <div class="filter mt-2">
      <button id="switchCheckDefault" class="filter-button" aria-label="Filter options">
        <i class="fa-solid fa-receipt filter-icon"></i>
        Display all tax
      </button>
      <button class="filter-button" aria-label="Filter options">
        <i class="fa-solid fa-sliders filter-icon"></i>
        Filters
      </button>
    </div>
  </div>
  <div class="listings-grid">
    <%for(let data of allData) {%>
      <a class="data-links" href="/listings/<%=data.id%>">
      <div class="listing-card" role="article" tabindex="0" aria-label="Cozy studio in downtown New York">
        <img class="listing-image" src="<%=data.image.url%>" alt="Cozy studio apartment" />
        <div class="listing-content">
          <div class="listing-location"><%=data.location%>,<%=data.country%></div>
          <h2 class="listing-title"><%=data.title%></h2>
          <div class="listing-footer">
            <div class="listing-price"><b>&#8377; <%=data.price%></b>/night &nbsp; <i class="tax-info">+18%GST</i></div>
            <div class="listing-rating" aria-label="4.8 out of 5 stars">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.27L18.18 21 16.54 13.97 22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
              4.8
            </div>
          </div>
        </div>
      </div>
    </a>
    <%}%>
  </div>
</body>

<script>
(function() {
  const slider = document.querySelector('.icon-slider');
  const leftArrow = document.querySelector('.arrow-left');
  const rightArrow = document.querySelector('.arrow-right');
  const items = document.querySelectorAll('.icon-item');

  // Scroll amount for arrows
  const scrollAmount = 100;

  // Scroll left button click
  leftArrow.addEventListener('click', () => {
    slider.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
  });

  // Scroll right button click
  rightArrow.addEventListener('click', () => {
    slider.scrollBy({ left: scrollAmount, behavior: 'smooth' });
  });

  // Item click selection toggle
  items.forEach(item => {
    item.addEventListener('click', () => {
      items.forEach(i => {
        i.classList.remove('selected');
        i.setAttribute('aria-selected', 'false');
      });
      item.classList.add('selected');
      item.setAttribute('aria-selected', 'true');
      item.focus();
    });

    // Keyboard accessibility: allow selection with Enter or Space
    item.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        item.click();
      }
    });
  });

  // Optional: touch drag support for slider on touch devices
  let isDown = false;
  let startX;
  let scrollLeft;

  slider.addEventListener('mousedown', (e) => {
    isDown = true;
    slider.classList.add('active');
    startX = e.pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
  });
  slider.addEventListener('mouseleave', () => {
    isDown = false;
    slider.classList.remove('active');
  });
  slider.addEventListener('mouseup', () => {
    isDown = false;
    slider.classList.remove('active');
  });
  slider.addEventListener('mousemove', (e) => {
    if(!isDown) return;
    e.preventDefault();
    const x = e.pageX - slider.offsetLeft;
    const walk = (x - startX) * 2; //scroll-fast
    slider.scrollLeft = scrollLeft - walk;
  });

  // Touch events for mobile
  slider.addEventListener('touchstart', (e) => {
    startX = e.touches[0].pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
  });
  slider.addEventListener('touchmove', (e) => {
    const x = e.touches[0].pageX - slider.offsetLeft;
    const walk = (x - startX) * 2;
    slider.scrollLeft = scrollLeft - walk;
  });
})();
</script>
